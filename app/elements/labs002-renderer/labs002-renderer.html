<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<!-- <link rel="import" href="../labs002-components/labs002-avatar.html">
 -->
<link rel="import" href="../edit_on-animation.html">
<link rel="import" href="../edit_off-animation.html">


<dom-module id="labs002-renderer">
  <style>
    :host {
      display: block;
        width: 100%;
        height: 100%;
    }



      labs002-avatar {
        width: 100%;
        height: 100%;
      }

    neon-animated-pages {
      height: 100%;
    }




/* !!!!!!!!!!!!!!!!!!!!!!!!!!!!!
HIJ STAAT AF, HIER TERUG AANZETTEN: ALLES WEG!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!! */
    #rendercanvas {
      visibility: show;
      height: 100%;
    }
    button {
      visibility: show;
      height: 0px;
    }

    .editer {
      visibility: visible;
      height: 50px;
    }


    /* ALL MATTERS avatarbtns */


    .renderbtns {
      height: 100px;
      padding-top: 100px;
      visibility: var(--zoom-items-visible);
      padding: 0px;
      margin: 0px;
    }

    .renderbtns button {
      outline: 0;
      background-color: rgba(0,0,0,0);
      width: 40px;
      height: 40px;
      border-radius: 20px;
      padding: 0px;
/*      margin: 0px 5px 0px 5px;*/
    }

    .renderbtns button img {
      width: 100%;
      height: 100%;
    }






  </style>
  <template> 

<neon-animated-pages id="pages" selected="{{selected}}" entry-animation="{{entryAnimation}}" exit-animation="{{exitAnimation}}">
  <neon-animatable>

        <div id="rendercanvas">
        </div>

        <div class="renderbtns layout vertical">

          <button on-click="edit">
            <img src="visualbtn.svg">
          </button>

          <button on-click="validate">
           <img src="waardenbtn.svg">
          </button>

        </div> 

    </neon-animatable>


  <neon-animatable>

        <getuigenlijst>
          met hier een + knop
          en een lijst met bestaande peers
        </getuigenlijst>
  </neon-animatable>
  </neon-animated-pages>





    <!-- en hier dan de validatie scherm -->

  </template>
</dom-module>
<script>
(function() {
  Polymer({
    is: 'labs002-renderer',

    behaviors: [
      Polymer.NeonAnimationRunnerBehavior
    ],


    properties: {
      objectname: {
        type: String
      },
      objectconfig: {
        type: Object,
        notify: true,
        //observer: "_config"
      },
      objectdata: {
        type: Object,
        observer: "_dataset",
        notify: true
      },

      objectname: {
        type: String
      },

      objectcomponent: {
        type: String
      }
     

      // editmode: {
      //   type: Boolean,
      //   value: false,
      //   observer: "_Scale"
      // },



      // animationConfig: {
      //   value: function() {
      //     return {
      //       'edit_on': {
      //         name: 'edit_on-animation',
      //         node: this,
      //         transformOrigin: '0px',
      //         timing: {duration: 230}
      //       },
      //       'edit_off': {
      //         name: 'edit_off-animation',
      //         node: this,
      //         timing: {duration: 230}
      //       }
      //     }          
      //   }
      // }

    },

    listeners: {
    // this event is fired when the animation finishes
      // 'neon-animation-finish': '_onNeonAnimationFinish'
    },

    ready: function(){
      console.log(this.objectdata);
      this.selected = 0;
      // var that = this;
      // this.addEventListener('zoom-state', function(e){
      //   console.log('Zoom state changed ', e.detail.state);
      //   that.editmode = e.detail.state;
      //   //that._Scale();
      // });

      // var that = this;
      // this.addEventListener('save-changes', function(e){
      //   //console.log('confirm-changes in renderer!!! ');
      //   that._save(e);
      // });



    },

    _save: function(e){
      console.log(e);
      //this.fire('update-api', { datasetkey: objectname, dataset: objectdata});
      //console.log('dataset zou geupdate moeten zijn');
    },

    _data: function(){
      // Maak eerst het render plaatske leeg
      console.log('data changed', this.objectdata);
    },

    _config: function(){
      // Maak eerst het render plaatske leeg
      console.log('config changed', this.objectconfig);
    },

    _dataset: function(){
      // Maak eerst het render plaatske leeg
      //console.log('data changed', this.objectdata);
      var myNode = document.getElementById("rendercanvas");
      myNode.innerHTML = '';

      var dataset = this.dataset;
      //console.log(dataset);
      //console.log(dataset.datasetLabels);
      var webcomponent = this.objectcomponent;

      console.log('Webcomponent: ',webcomponent);

      // De gepaste webcomponent inladen

      this.importHref("../elements/labs002-components/"+webcomponent+".html", function(e) {
        var rendercanvas = this.$.rendercanvas;
        var newelem = document.createElement(webcomponent);
        //var newelem = document.querySelector("labs002-avatar");
        // e.target.import is the import document.
        console.log(newelem, "config: ", this.objectconfig);
        console.log(newelem, "data: ", this.objectdata);
        newelem.config = this.objectconfig;
        newelem.data = this.objectdata;
        newelem.id = this.objectname;
        rendercanvas.appendChild(newelem);
      });
    },

    toPeerlist: function(){
      this.selected = 1;
    },

    edit: function(){},

    validate: function(){
      console.log("ask for validation");
      this.fire('add-getuige', {objectname: this.objectname, objectconfig: this.objectconfig, objectdata: this.objectdata });
    }


     



  });
})();
</script>
